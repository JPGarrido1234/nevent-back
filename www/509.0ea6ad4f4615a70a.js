"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[509],{509:(v,g,a)=>{a.r(g),a.d(g,{LoginPageModule:()=>O});var d=a(6814),i=a(95),s=a(7852),l=a(2881),f=a(5861),t=a(9468),p=a(9862),m=a(553);let P=(()=>{class e{constructor(n){this.http=n,this.baseUrl=m.N.apiUrl}isUserConfigured(){return this.http.get(`${this.baseUrl}/public/user`)}completeSignup(n,o){const c=`${this.baseUrl}/users/complete`,u=(new p.WM).set("Authorization",n);return this.http.post(c,{idToken:o},{headers:u})}requestLogin(n){return this.http.post(`${this.baseUrl}/auth/login`,n)}reset(n){return this.http.put(`${this.baseUrl}/auth/login`,n)}confirm(n){return this.http.get(`${this.baseUrl}/auth/login/confirm?confirmationToken=${n}`)}}return e.\u0275fac=function(n){return new(n||e)(t.LFG(p.eN))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function b(e,r){1&e&&(t.TgZ(0,"ion-item",5),t._UZ(1,"ion-input",11),t.qZA())}function _(e,r){1&e&&(t.TgZ(0,"ion-item",5),t._UZ(1,"ion-input",12),t.qZA())}function w(e,r){if(1&e){const n=t.EpF();t.TgZ(0,"ion-button",13),t.NdJ("click",function(){t.CHM(n);const c=t.oxw();return t.KtG(c.resetPassword())}),t._uU(1,"\xbfOlvidaste la password?"),t.qZA()}if(2&e){const n=t.oxw();t.Q6J("disabled",n.disableResend)}}function C(e,r){if(1&e){const n=t.EpF();t.TgZ(0,"ion-button",13),t.NdJ("click",function(){t.CHM(n);const c=t.oxw();return t.KtG(c.resetPassword())}),t._uU(1,"\xbfNo has recibido el email?"),t.qZA()}if(2&e){const n=t.oxw();t.Q6J("disabled",n.disableResend)}}const M=[{path:"",component:(()=>{class e{constructor(n,o,c){this.authService=n,this.router=o,this.toastController=c,this.requestingLogin=!1,this.requestPassword=!1,this.requestOtp=!1,this.disableResend=!0,this.showPasswordError=!1,this.loginForm=new i.cw({email:new i.NI("",[i.kI.required,i.kI.email]),password:new i.NI(""),otp:new i.NI("")})}ngOnInit(){}requestLogin(){this.requestingLogin=!0,this.authService.requestLogin(this.loginForm.value).subscribe(n=>{n.loggedIn?(localStorage.setItem("accessToken",n.token),this.router.navigate(["/home"])):("password"===n.method?(this.requestingLogin=!1,this.requestPassword=!0,"failed"===n.status&&(this.showPasswordError=!0)):(this.presentToast("bottom","Te hemos enviado un email de confirmaci\xf3n","success"),this.requestingLogin=!1,this.requestOtp=!0),setTimeout(()=>{this.disableResend=!1},5e3))})}resetPassword(){this.authService.reset(this.loginForm.value).subscribe(()=>{this.requestingLogin=!1,this.requestPassword=!1,this.presentToast("top","La password se ha reestablecido correctamente","success")},n=>{this.requestingLogin=!1,this.presentToast("top","Ha ocurrido un error","danger")})}presentToast(n,o,c){var u=this;return(0,f.Z)(function*(){yield(yield u.toastController.create({message:o,duration:5e3,position:n,color:c})).present()})()}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(P),t.Y36(l.F0),t.Y36(s.yF))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-login"]],decls:21,vars:7,consts:[[1,"ion-padding",3,"fullscreen"],[1,"fullscreen"],[1,"ion-justify-content-center","ion-align-items-center","title-row"],[1,"ion-justify-content-center","ion-align-items-center","form-row"],["mode","md",3,"formGroup"],["lines","none",1,"datos_basicos"],["label","Correo electr\xf3nico","type","email","label-placement","floating","formControlName","email"],["lines","none","class","datos_basicos",4,"ngIf"],[1,"ion-justify-content-center","ion-align-items-end","actions-row"],["fill","clear","expand","full",3,"disabled","click",4,"ngIf"],["shape","round","expand","full",3,"disabled","click"],["label","Contrase\xf1a","label-placement","floating","type","password","formControlName","password"],["label","C\xf3digo de verificaci\xf3n","label-placement","floating","formControlName","otp"],["fill","clear","expand","full",3,"disabled","click"]],template:function(n,o){1&n&&(t.TgZ(0,"ion-content",0),t._UZ(1,"div",1),t.TgZ(2,"ion-grid")(3,"ion-row",2)(4,"ion-col")(5,"ion-label")(6,"h1"),t._uU(7,"Est\xe1s a punto de disfrutar de una experiencia \xfanica"),t.qZA()()()(),t.TgZ(8,"ion-row",3)(9,"ion-col")(10,"ion-list",4)(11,"ion-item",5),t._UZ(12,"ion-input",6),t.qZA(),t.YNc(13,b,2,0,"ion-item",7),t.YNc(14,_,2,0,"ion-item",7),t.qZA()()(),t.TgZ(15,"ion-row",8)(16,"ion-col"),t.YNc(17,w,2,1,"ion-button",9),t.YNc(18,C,2,1,"ion-button",9),t.TgZ(19,"ion-button",10),t.NdJ("click",function(){return o.requestLogin()}),t._uU(20,"Continuar"),t.qZA()()()()()),2&n&&(t.Q6J("fullscreen",!0),t.xp6(10),t.Q6J("formGroup",o.loginForm),t.xp6(3),t.Q6J("ngIf",o.requestPassword),t.xp6(1),t.Q6J("ngIf",o.requestOtp),t.xp6(3),t.Q6J("ngIf",o.requestPassword),t.xp6(1),t.Q6J("ngIf",o.requestOtp),t.xp6(1),t.Q6J("disabled",!o.loginForm.valid||o.requestingLogin))},dependencies:[d.O5,i.JJ,i.JL,s.YG,s.wI,s.W2,s.jY,s.pK,s.Ie,s.Q$,s.q_,s.Nd,s.j9,i.sg,i.u],styles:["ion-content[_ngcontent-%COMP%]{color:#fff;overflow:hidden;--background: center / cover url(fondo_login.9b40c25807b8d9e4.png)}ion-content[_ngcontent-%COMP%]   div.fullscreen[_ngcontent-%COMP%]{width:100%;height:100%;overflow:hidden;position:absolute;top:0;left:0;background:linear-gradient(#A9937B,#000000);opacity:.7}ion-content[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]{--background: transparent}ion-content[_ngcontent-%COMP%]   .list-md[_ngcontent-%COMP%]{background:transparent}ion-content[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--background: transparent}ion-content[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{border-radius:10px;background:white;color:#000}ion-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-weight:600;font-size:30px;line-height:45px}ion-content[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{text-align:center}ion-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#fff}.datos_basicos[_ngcontent-%COMP%]{margin-bottom:24px}ion-grid[_ngcontent-%COMP%]{height:100%}ion-grid[_ngcontent-%COMP%]   ion-row.title-row[_ngcontent-%COMP%]{height:30%}ion-grid[_ngcontent-%COMP%]   ion-row.form-row[_ngcontent-%COMP%]{height:50%}ion-grid[_ngcontent-%COMP%]   ion-row.actions-row[_ngcontent-%COMP%]{height:20%}ion-button[_ngcontent-%COMP%]{--padding-top: 18px;--padding-bottom: 18px}"]}),e})()}];let L=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[l.Bz.forChild(M),l.Bz]}),e})(),O=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[d.ez,i.u5,s.Pc,L,i.UX]}),e})()}}]);